<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quản Lý Giao Dịch - Trường Đại Học Thủy Lợi</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>
<body class="flex flex-col min-h-screen font-sans bg-gray-100 text-gray-800">

    <div id="loadingOverlay" class="fixed inset-0 bg-white bg-opacity-80 z-[1001] flex flex-col justify-center items-center hidden">
        <div class="spinner border-4 border-gray-200 border-l-blue-500 rounded-full w-12 h-12 animate-spin"></div>
        <p id="loadingText" class="mt-4 text-gray-700 font-bold">Đang tải...</p>
    </div>

    <header class="bg-blue-900 text-white p-4 flex justify-between items-center shadow-md flex-wrap">
        <div class="flex-shrink-0 mb-2 md:mb-0">
            <span class="font-bold text-lg">Trường Đại học Thủy Lợi</span>
        </div>
        <div class="flex flex-grow justify-end items-center gap-5 flex-wrap">
            <nav class="flex-grow md:flex-grow-0">
                <ul class="flex gap-5 m-0 p-0 list-none text-sm md:text-base flex-wrap justify-end">
                    <li><a href="#" class="text-white no-underline py-1 transition-colors duration-300 hover:text-blue-200">Trang chủ</a></li>
                    <li><a href="#" class="text-white no-underline py-1 transition-colors duration-300 hover:text-blue-200">Quản lý cửa hàng</a></li>
                </ul>
            </nav>
            <div class="flex border border-gray-600 rounded-md overflow-hidden flex-grow md:flex-grow-0 max-w-sm">
                <input type="text" placeholder="Nhập nội dung tìm kiếm" class="border-none py-2 px-3 outline-none bg-gray-700 text-white placeholder-gray-400 flex-grow">
                <button class="bg-blue-500 text-white border-none py-2 px-4 cursor-pointer transition-colors duration-300 hover:bg-blue-600">Tìm kiếm</button>
            </div>
            <span id="userIdDisplay" class="text-sm flex-shrink-0">Chào mừng, User!</span>
        </div>
    </header>

    <main class="container w-[90%] max-w-[1200px] mx-auto my-5 bg-white p-5 rounded-lg shadow-md flex-grow">
        <div class="flex justify-between items-center mb-5 pb-4 border-b border-gray-200 flex-wrap gap-4">
            <div class="flex flex-wrap gap-2">
                <button class="bg-blue-500 text-white py-2 px-4 rounded-md cursor-pointer text-sm inline-flex items-center gap-1 hover:bg-blue-600" id="addTransactionBtn">
                    <i class="fas fa-plus"></i> Thêm
                </button>
                <button class="bg-gray-600 text-white py-2 px-4 rounded-md cursor-pointer text-sm inline-flex items-center gap-1 hover:bg-gray-700">
                    <i class="fas fa-file-export"></i> Xuất ra file <i class="fas fa-caret-down"></i>
                </button>
            </div>
            <div class="flex items-center flex-wrap gap-2">
                <div class="relative flex">
                    <input type="text" id="transactionSearchInput" placeholder="Tìm kiếm giao dịch..." class="py-2 px-3 border border-gray-300 rounded-md text-sm focus:outline-none focus:ring-2 focus:ring-blue-500">
                    <button class="bg-gray-200 text-gray-800 py-2 px-4 rounded-md cursor-pointer text-sm inline-flex items-center gap-1 hover:bg-gray-300 ml-2" id="searchTransactionBtn">
                        <i class="fas fa-search"></i> Tìm kiếm
                    </button>
                </div>
                <div class="inline-flex items-center gap-1 text-sm">
                    <span>Kết quả</span>
                    <select id="itemsPerPageSelect" class="py-2 px-3 border border-gray-300 rounded-md bg-gray-50">
                        <option value="5">5</option>
                        <option value="10">10</option>
                        <option value="20">20</option>
                        <option value="50">50</option>
                    </select>
                </div>
            </div>
        </div>

        <div class="overflow-x-auto mb-5">
            <table class="w-full border-collapse mb-4">
                <thead>
                    <tr class="bg-gray-700 text-white">
                        <th class="py-3 px-4 text-left"><input type="checkbox" id="selectAllCheckbox" class="form-checkbox h-4 w-4 text-blue-600 rounded"></th>
                        <th class="py-3 px-4 text-left whitespace-nowrap" data-sort-by="actions">Hành động <i class="fas fa-sort cursor-pointer text-gray-400 text-xs ml-1"></i></th>
                        <th class="py-3 px-4 text-left whitespace-nowrap" data-sort-by="id">ID <i class="fas fa-sort cursor-pointer text-gray-400 text-xs ml-1"></i></th>
                        <th class="py-3 px-4 text-left whitespace-nowrap" data-sort-by="customerName">Khách hàng <i class="fas fa-sort cursor-pointer text-gray-400 text-xs ml-1"></i></th>
                        <th class="py-3 px-4 text-left whitespace-nowrap" data-sort-by="employeeName">Nhân viên <i class="fas fa-sort cursor-pointer text-gray-400 text-xs ml-1"></i></th>
                        <th class="py-3 px-4 text-left whitespace-nowrap" data-sort-by="amount">Số tiền <i class="fas fa-sort cursor-pointer text-gray-400 text-xs ml-1"></i></th>
                        <th class="py-3 px-4 text-left whitespace-nowrap" data-sort-by="purchaseDate">Ngày mua <i class="fas fa-sort cursor-pointer text-gray-400 text-xs ml-1"></i></th>
                    </tr>
                </thead>
                <tbody id="transactionTableBody">
                </tbody>
            </table>
            <button class="bg-red-500 text-white py-2 px-4 rounded-md cursor-pointer text-sm inline-flex items-center gap-1 hover:bg-red-600 delete-selected">
                <i class="fas fa-trash-alt"></i> DELETE SELECTED RECORDS
            </button>
        </div>

        <div class="flex justify-between items-center pt-4 border-t border-gray-200 mt-5 flex-wrap gap-2">
            <nav>
                <ul id="paginationList" class="flex gap-1 m-0 p-0 list-none">
                </ul>
            </nav>
            <span id="paginationInfo" class="text-sm text-gray-600"></span>
        </div>
    </main>

    <footer class="bg-blue-900 text-white p-5 mt-auto">
        <div class="text-center md:text-left">
            <p class="font-bold text-lg mb-2">TRƯỜNG ĐẠI HỌC THỦY LỢI</p>
            <p class="ml-0 md:ml-48">Địa chỉ: 175 Tây Sơn, Đống Đa, Hà Nội</p>
            <p class="ml-0 md:ml-48">Điện thoại: (024) 38522201 - Fax: (024) 35633351</p>
            <p class="ml-0 md:ml-48">Email: <a href="mailto:pkhc@tlu.edu.vn" class="text-blue-200 no-underline hover:underline">pkhc@tlu.edu.vn</a></p>
        </div>
    </footer>

    <div id="addTransactionModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4" style="display: none;">
        <div class="bg-white mx-auto p-5 border border-gray-300 rounded-lg w-11/12 max-w-lg shadow-lg relative animate-fade-in-down">
            <div class="flex justify-between items-center border-b pb-3 mb-5">
                <h2 id="modalTitle" class="text-2xl font-semibold text-gray-800">Thêm giao dịch</h2>
                <span class="close-button text-gray-500 text-3xl font-bold cursor-pointer hover:text-black">&times;</span>
            </div>
            <div class="modal-body">
                <form id="addTransactionForm">
                    <input type="hidden" id="transactionId" name="transactionId">
                    <div class="mb-4">
                        <label for="customerName" class="block mb-1 font-semibold text-gray-700">Khách hàng</label>
                        <input type="text" id="customerName" name="customerName" required class="w-full p-2 border border-gray-300 rounded-md text-base focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500" maxlength="30">
                        <div class="text-red-600 text-sm mt-1" id="customerNameError"></div>
                    </div>
                    <div class="mb-4">
                        <label for="employeeName" class="block mb-1 font-semibold text-gray-700">Nhân viên</label>
                        <input type="text" id="employeeName" name="employeeName" required class="w-full p-2 border border-gray-300 rounded-md text-base focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500" maxlength="30">
                        <div class="text-red-600 text-sm mt-1" id="employeeNameError"></div>
                    </div>
                    <div class="mb-4">
                        <label for="amount" class="block mb-1 font-semibold text-gray-700">Số tiền</label>
                        <input type="number" id="amount" name="amount" required min="0" class="w-full p-2 border border-gray-300 rounded-md text-base focus:outline-none focus:border-blue-500 focus:ring-1 focus:ring-blue-500">
                        <div class="text-red-600 text-sm mt-1" id="amountError"></div>
                    </div>
                    <div class="flex justify-end gap-3 pt-4 border-t border-gray-200 mt-5 bg-gray-50 rounded-b-lg -mx-5 -mb-5 px-5 py-3">
                        <button type="button" class="bg-gray-300 text-gray-800 py-2 px-4 rounded-md cursor-pointer hover:bg-gray-400" id="cancelAddTransaction">Hủy</button>
                        <button type="submit" class="bg-green-500 text-white py-2 px-4 rounded-md cursor-pointer hover:bg-green-600">Thêm</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <div id="confirmationModal" class="modal fixed inset-0 bg-black bg-opacity-50 z-50 flex justify-center items-center p-4" style="display: none;">
        <div class="bg-white mx-auto p-5 border border-gray-300 rounded-lg w-11/12 max-w-sm shadow-lg relative animate-fade-in-down">
            <div class="flex justify-center items-center pb-3">
                <h2 id="confirmationModalTitle" class="text-xl font-semibold text-gray-800">Xác nhận</h2>
            </div>
            <div class="text-gray-700 text-center mb-5">
                <p id="confirmationModalMessage">Bạn có chắc chắn muốn thực hiện thao tác này?</p>
            </div>
            <div class="flex justify-center gap-3 pt-4 border-t border-gray-200">
                <button type="button" class="bg-gray-300 text-gray-800 py-2 px-4 rounded-md cursor-pointer hover:bg-gray-400" id="cancelConfirmBtn">Hủy</button>
                <button type="button" class="bg-red-500 text-white py-2 px-4 rounded-md cursor-pointer hover:bg-red-600" id="confirmActionBtn">Xác nhận</button>
            </div>
        </div>
    </div>

    <script src="data.js"></script>
    <script src="script.js"></script>
</body>
</html>